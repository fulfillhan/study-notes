# 영속성 전이

## 영속성 전이(CASCADE)
`@OneToMany(mappedBy="parent", cascade=CascadeType.ALL)`
- 특정 엔티티를 영속 상태로 만들때 연관된 엔티티도 같이 영속 상태로 만들고 싶을 때 사용한다.

  예)부모 엔티티를 저장할 때 연관된 자식 엔티티도 저장하는 경우

### **주의사항**
- 연관관계 매핑과 아무 관련이 없다.
- 엔티티를 영속화할 때 연관된 엔티티를 함께 영속화할때 편리하게 사용하는 것일뿐!
- 하나의 부모 엔티티가 자식엔티티를 관리할 때 사용 즉 단일 엔티티에 완전히 종속적일 때. 만약 자식 엔티티가 다른 엔티티와 연관관계에 있다면 사용하면 안된다.

### 종류
- ALL :  모두 적용
- PERSIST: 영속
- REMOVE: 삭제

## 고아객체
`orphanRemoval = true`

- 고아 객체 제거: 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 자동으로 삭제한다.
- Parent parent1 = em.find(Parent.class, id);
  parent1.getChildren().remove(0);
  //자식 엔티티를 컬렉션에서 제거

### 주의 사항
- 참조가 제거된 엔티티는 다른 객체에서 참조되지 않은 고아 객체로 보고 삭제하는 기능이다.
- 참조하는 곳이 하나일때 사용한다.(단일참조)
- 특정 엔티티가 개인 소유할 때
- @OneToOne @OneToMany일때 사용한다.

## 영속성 전이 + 고아 객체
`CascadeType.ALL + orphanRemoval=true`

- 두 옵션을 모두 사용하면 **부모 엔티티에서 자식 엔티티의 생명주기를 관리**하게 된다.

